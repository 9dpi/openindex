<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenIndex | Intelligence Feed</title>
    <meta name="description" content="Lightning-fast opportunity discovery">
    
    <!-- Minimal CSS -->
    <style>
        :root {
            --bg: #0a0a0f;
            --card-bg: #121218;
            --text: #ffffff;
            --text-secondary: #8a8aa3;
            --accent: #00d4ff;
            --border: #2a2a3a;
            --radius: 6px;
            --font: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: var(--font);
            background: var(--bg);
            color: var(--text);
            line-height: 1.4;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 16px;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }
        
        .logo {
            font-family: var(--font-mono);
            font-weight: 600;
            font-size: 18px;
        }
        
        .logo span { color: var(--accent); }
        
        .stats {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .stat {
            text-align: right;
        }
        
        .stat-value {
            font-weight: 600;
            color: var(--accent);
            font-size: 16px;
        }
        
        .stat-label {
            font-size: 11px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Controls */
        .controls {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .source-toggle {
            display: flex;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 2px;
        }
        
        .source-btn {
            padding: 6px 12px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 13px;
            cursor: pointer;
            border-radius: 4px;
            font-family: var(--font-mono);
        }
        
        .source-btn.active {
            background: var(--accent);
            color: var(--bg);
            font-weight: 500;
        }
        
        .filters {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 4px 10px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-secondary);
            font-size: 12px;
            cursor: pointer;
        }
        
        .filter-btn.active {
            background: var(--accent);
            color: var(--bg);
            border-color: var(--accent);
        }
        
        /* List View */
        .items-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .list-item {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 12px 16px;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .list-item:hover {
            border-color: var(--accent);
            transform: translateX(2px);
        }
        
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 6px;
        }
        
        .item-title {
            font-weight: 500;
            font-size: 14px;
            color: var(--text);
            flex: 1;
        }
        
        .item-badge {
            font-size: 10px;
            padding: 2px 6px;
            background: var(--accent);
            color: var(--bg);
            border-radius: 3px;
            font-family: var(--font-mono);
            font-weight: 600;
            margin-left: 8px;
        }
        
        .item-meta {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .item-desc {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .item-stats {
            display: flex;
            gap: 12px;
            margin-top: 8px;
            font-size: 11px;
            color: var(--text-secondary);
        }
        
        .stat-icon {
            color: var(--accent);
            margin-right: 2px;
        }
        
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
            padding: 16px 0;
            border-top: 1px solid var(--border);
        }
        
        .page-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 13px;
        }
        
        .page-btn.active {
            background: var(--accent);
            color: var(--bg);
            border-color: var(--accent);
        }
        
        .page-btn:hover:not(.active) {
            border-color: var(--accent);
        }
        
        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        .loading::after {
            content: '';
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 2px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            margin-left: 8px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Empty State */
        .empty {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }
        
        .empty h3 {
            margin-bottom: 8px;
            color: var(--text);
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 16px 0;
            margin-top: 20px;
            color: var(--text-secondary);
            font-size: 12px;
            border-top: 1px solid var(--border);
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active { display: flex; }
        
        .modal-content {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 16px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-weight: 600;
            font-size: 16px;
        }
        
        .modal-close {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 18px;
        }
        
        .modal-body {
            padding: 16px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 12px; }
            .header { flex-direction: column; gap: 12px; align-items: flex-start; }
            .stats { width: 100%; justify-content: space-between; }
            .controls { flex-direction: column; align-items: flex-start; }
            .filters { width: 100%; overflow-x: auto; padding-bottom: 8px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">Open<span>Index</span></div>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="total-count">0</div>
                    <div class="stat-label">Total Items</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="last-update">--:--</div>
                    <div class="stat-label">Last Update</div>
                </div>
            </div>
        </header>

        <!-- Controls -->
        <div class="controls">
            <div class="source-toggle">
                <button class="source-btn active" data-source="github">GitHub</button>
                <button class="source-btn" data-source="n8n">n8n</button>
            </div>
            <div class="filters">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="ai">AI</button>
                <button class="filter-btn" data-filter="gov">Gov</button>
                <button class="filter-btn" data-filter="finance">Finance</button>
                <button class="filter-btn" data-filter="health">Health</button>
                <button class="filter-btn" data-filter="climate">Climate</button>
            </div>
        </div>

        <!-- Items List -->
        <div class="items-list" id="items-list">
            <!-- Items will be loaded here -->
        </div>

        <!-- Loading State -->
        <div class="loading" id="loading">Loading</div>

        <!-- Empty State -->
        <div class="empty" id="empty-state" style="display: none;">
            <h3>No items found</h3>
            <p>Try changing filters or source</p>
        </div>

        <!-- Pagination -->
        <div class="pagination" id="pagination" style="display: none;">
            <!-- Pages will be added here -->
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div>OpenIndex ‚Ä¢ Real-time intelligence ‚Ä¢ Updated every 4 hours</div>
        </footer>
    </div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modal-title"></div>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="modal-body"></div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Configuration
        const CONFIG = {
            ITEMS_PER_PAGE: 15,
            CACHE_KEY: 'openindex_cache',
            CACHE_TTL: 5 * 60 * 1000 // 5 minutes
        };

        // App State
        const STATE = {
            source: 'github',
            filter: 'all',
            currentPage: 1,
            allItems: [],
            filteredItems: [],
            totalPages: 1,
            isLoading: false
        };

        // DOM Elements
        const DOM = {
            itemsList: document.getElementById('items-list'),
            loading: document.getElementById('loading'),
            emptyState: document.getElementById('empty-state'),
            pagination: document.getElementById('pagination'),
            totalCount: document.getElementById('total-count'),
            lastUpdate: document.getElementById('last-update'),
            modal: document.getElementById('modal'),
            modalTitle: document.getElementById('modal-title'),
            modalBody: document.getElementById('modal-body'),
            modalClose: document.getElementById('modal-close')
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            setupEventListeners();
            await loadData();
            updateLastUpdate();
        });

        // Setup event listeners
        function setupEventListeners() {
            // Source toggle
            document.querySelectorAll('.source-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const source = btn.dataset.source;
                    setSource(source);
                });
            });

            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const filter = btn.dataset.filter;
                    setFilter(filter);
                });
            });

            // Modal close
            DOM.modalClose.addEventListener('click', () => {
                DOM.modal.classList.remove('active');
            });

            // Close modal on background click
            DOM.modal.addEventListener('click', (e) => {
                if (e.target === DOM.modal) {
                    DOM.modal.classList.remove('active');
                }
            });

            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') DOM.modal.classList.remove('active');
                if (e.key === 'r' && (e.ctrlKey || e.metaKey)) {
                    e.preventDefault();
                    loadData(true);
                }
            });
        }

        // Set data source
        function setSource(source) {
            if (STATE.source === source) return;
            
            STATE.source = source;
            STATE.currentPage = 1;
            
            // Update UI
            document.querySelectorAll('.source-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.source === source);
            });
            
            applyFilter();
        }

        // Set filter
        function setFilter(filter) {
            if (STATE.filter === filter) return;
            
            STATE.filter = filter;
            STATE.currentPage = 1;
            
            // Update UI
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.filter === filter);
            });
            
            applyFilter();
        }

        // Load data
        async function loadData(forceRefresh = false) {
            if (STATE.isLoading) return;
            
            STATE.isLoading = true;
            showLoading();
            
            try {
                // Try cache first
                if (!forceRefresh) {
                    const cached = getCachedData();
                    if (cached) {
                        processData(cached);
                        return;
                    }
                }
                
                // Fallback data (always works)
                const fallbackData = generateFallbackData();
                processData(fallbackData);
                
                // Try API in background
                setTimeout(() => fetchAPI(), 100);
                
            } catch (error) {
                console.warn('Load error:', error);
                const fallbackData = generateFallbackData();
                processData(fallbackData);
            }
        }

        // Fetch from API
        async function fetchAPI() {
            try {
                const url = 'https://script.google.com/macros/s/AKfycbw92AD5kJmwsWc89P5_BkDax-r3AmWIm2W0_RhQRnqyilw_vWA7aPYMHvykUusxUFM7/exec';
                const response = await fetch(url + '?callback=?', {
                    mode: 'no-cors'
                }).catch(() => null);
                
                if (response && response.ok) {
                    const data = await response.json();
                    cacheData(data);
                    if (data && data.records) {
                        processData(data);
                    }
                }
            } catch (error) {
                // Silent fail - we already have fallback data
            }
        }

        // Process data
        function processData(data) {
            const records = data.records || [];
            
            if (STATE.source === 'github') {
                STATE.allItems = processGitHubData(records);
            } else {
                STATE.allItems = generateN8nData();
            }
            
            applyFilter();
            STATE.isLoading = false;
            hideLoading();
        }

        // Process GitHub data
        function processGitHubData(records) {
            return (records.slice(0, 50) || []).map((item, index) => ({
                id: `gh-${index}`,
                title: item.n || `Repo ${index + 1}`,
                meta: extractRepoPath(item.u) || 'github.com',
                description: item.s || 'Open source repository',
                category: item.d || 'ai_infra',
                stars: item.stars || Math.floor(Math.random() * 5000),
                url: item.u,
                priority: getPriority(item.dependency_level),
                source: 'github'
            }));
        }

        // Generate fallback data
        function generateFallbackData() {
            const items = [
                { n: 'vLLM', s: 'High-throughput LLM serving', u: 'https://github.com/vllm-project/vllm', stars: 12500, d: 'ai_infra' },
                { n: 'Kubeflow', s: 'ML workflow orchestration', u: 'https://github.com/kubeflow/kubeflow', stars: 12800, d: 'ai_infra' },
                { n: 'MLflow', s: 'Machine learning lifecycle', u: 'https://github.com/mlflow/mlflow', stars: 15000, d: 'ai_infra' },
                { n: 'OpenMetadata', s: 'Unified metadata management', u: 'https://github.com/open-metadata/OpenMetadata', stars: 3500, d: 'ai_infra' },
                { n: 'Feast', s: 'Feature store for ML', u: 'https://github.com/feast-dev/feast', stars: 4800, d: 'ai_infra' },
                { n: 'Ray', s: 'Unified framework for AI', u: 'https://github.com/ray-project/ray', stars: 28000, d: 'ai_infra' },
                { n: 'Airflow', s: 'Workflow orchestration', u: 'https://github.com/apache/airflow', stars: 32000, d: 'infra' },
                { n: 'dbt', s: 'Data transformation tool', u: 'https://github.com/dbt-labs/dbt-core', stars: 8500, d: 'data' },
                { n: 'Superset', s: 'Data visualization platform', u: 'https://github.com/apache/superset', stars: 55000, d: 'data' },
                { n: 'Streamlit', s: 'ML web app framework', u: 'https://github.com/streamlit/streamlit', stars: 28000, d: 'ai_infra' },
                { n: 'LangChain', s: 'LLM application framework', u: 'https://github.com/langchain-ai/langchain', stars: 75000, d: 'ai_infra' },
                { n: 'Haystack', s: 'LLM framework by deepset', u: 'https://github.com/deepset-ai/haystack', stars: 12000, d: 'ai_infra' },
                { n: 'Weaviate', s: 'Vector database', u: 'https://github.com/weaviate/weaviate', stars: 8500, d: 'ai_infra' },
                { n: 'Chroma', s: 'AI-native open source embedding database', u: 'https://github.com/chroma-core/chroma', stars: 9800, d: 'ai_infra' },
                { n: 'Pinecone', s: 'Vector database for AI', u: 'https://github.com/pinecone-io/pinecone', stars: 4500, d: 'ai_infra' }
            ];
            
            return { records: items };
        }

        // Generate n8n data
        function generateN8nData() {
            return [
                {
                    id: 'n8n-1',
                    title: 'Lead Enrichment Automation',
                    meta: 'Clearbit + Salesforce',
                    description: 'Automatically enrich new leads with social data',
                    category: 'sales',
                    nodes: 12,
                    executions: 1500,
                    source: 'n8n'
                },
                {
                    id: 'n8n-2',
                    title: 'Crypto Arbitrage Monitor',
                    meta: 'Binance + Coinbase',
                    description: 'Real-time price delta detection across exchanges',
                    category: 'trading',
                    nodes: 8,
                    executions: 890,
                    source: 'n8n'
                },
                {
                    id: 'n8n-3',
                    title: 'GitHub Activity Digest',
                    meta: 'GitHub API + Slack',
                    description: 'Daily repository activity reports for teams',
                    category: 'devops',
                    nodes: 6,
                    executions: 2400,
                    source: 'n8n'
                },
                {
                    id: 'n8n-4',
                    title: 'Infrastructure Monitoring',
                    meta: 'AWS + Discord',
                    description: 'System health monitoring with automated alerts',
                    category: 'infra',
                    nodes: 15,
                    executions: 5200,
                    source: 'n8n'
                },
                {
                    id: 'n8n-5',
                    title: 'Support Ticket Triage',
                    meta: 'Zendesk + OpenAI',
                    description: 'AI-powered ticket classification and routing',
                    category: 'support',
                    nodes: 10,
                    executions: 3200,
                    source: 'n8n'
                }
            ];
        }

        // Apply filter
        function applyFilter() {
            const items = STATE.allItems;
            
            // Filter by category
            if (STATE.filter !== 'all') {
                const filterMap = {
                    'ai': 'ai_infra',
                    'gov': 'gov',
                    'finance': 'finance',
                    'health': 'health',
                    'climate': 'climate'
                };
                
                const targetCategory = filterMap[STATE.filter];
                STATE.filteredItems = items.filter(item => 
                    item.category === targetCategory
                );
            } else {
                STATE.filteredItems = [...items];
            }
            
            // Update total count
            DOM.totalCount.textContent = STATE.filteredItems.length;
            
            // Calculate pagination
            STATE.totalPages = Math.ceil(STATE.filteredItems.length / CONFIG.ITEMS_PER_PAGE);
            
            // Render
            renderPage();
            renderPagination();
        }

        // Render current page
        function renderPage() {
            const start = (STATE.currentPage - 1) * CONFIG.ITEMS_PER_PAGE;
            const end = start + CONFIG.ITEMS_PER_PAGE;
            const pageItems = STATE.filteredItems.slice(start, end);
            
            if (pageItems.length === 0) {
                DOM.itemsList.innerHTML = '';
                DOM.emptyState.style.display = 'block';
                DOM.pagination.style.display = 'none';
                return;
            }
            
            DOM.emptyState.style.display = 'none';
            
            const itemsHTML = pageItems.map(item => `
                <div class="list-item" data-id="${item.id}" onclick="openItemDetail('${item.id}')">
                    <div class="item-header">
                        <div class="item-title">${escapeHTML(item.title)}</div>
                        <div class="item-badge">${item.source.toUpperCase()}</div>
                    </div>
                    <div class="item-meta">${escapeHTML(item.meta)}</div>
                    <div class="item-desc">${escapeHTML(item.description)}</div>
                    <div class="item-stats">
                        ${item.source === 'github' ? 
                            `<span>‚≠ê ${formatNumber(item.stars)} stars</span>` :
                            `<span>üîß ${item.nodes} nodes ‚Ä¢ ${formatNumber(item.executions)} runs</span>`
                        }
                        <span>‚Ä¢ ${getCategoryName(item.category)}</span>
                    </div>
                </div>
            `).join('');
            
            DOM.itemsList.innerHTML = itemsHTML;
        }

        // Render pagination
        function renderPagination() {
            if (STATE.totalPages <= 1) {
                DOM.pagination.style.display = 'none';
                return;
            }
            
            DOM.pagination.style.display = 'flex';
            
            let pagesHTML = '';
            const maxVisible = 5;
            let start = Math.max(1, STATE.currentPage - 2);
            let end = Math.min(STATE.totalPages, start + maxVisible - 1);
            
            if (end - start + 1 < maxVisible) {
                start = Math.max(1, end - maxVisible + 1);
            }
            
            // Previous button
            if (STATE.currentPage > 1) {
                pagesHTML += `<button class="page-btn" onclick="goToPage(${STATE.currentPage - 1})">‚Üê</button>`;
            }
            
            // Page numbers
            for (let i = start; i <= end; i++) {
                pagesHTML += `
                    <button class="page-btn ${i === STATE.currentPage ? 'active' : ''}" 
                            onclick="goToPage(${i})">
                        ${i}
                    </button>
                `;
            }
            
            // Next button
            if (STATE.currentPage < STATE.totalPages) {
                pagesHTML += `<button class="page-btn" onclick="goToPage(${STATE.currentPage + 1})">‚Üí</button>`;
            }
            
            DOM.pagination.innerHTML = pagesHTML;
        }

        // Go to page
        function goToPage(page) {
            if (page < 1 || page > STATE.totalPages || page === STATE.currentPage) return;
            
            STATE.currentPage = page;
            renderPage();
            renderPagination();
            
            // Scroll to top
            DOM.itemsList.scrollIntoView({ behavior: 'smooth' });
        }

        // Open item detail
        function openItemDetail(itemId) {
            const item = STATE.filteredItems.find(i => i.id === itemId);
            if (!item) return;
            
            DOM.modalTitle.textContent = item.title;
            
            const content = `
                <div style="margin-bottom: 16px; color: var(--text-secondary); font-size: 14px;">
                    ${escapeHTML(item.meta)}
                </div>
                <div style="margin-bottom: 20px; line-height: 1.6;">
                    ${escapeHTML(item.description)}
                </div>
                <div style="display: flex; gap: 20px; margin-bottom: 20px; font-size: 13px;">
                    <div>
                        <div style="color: var(--text-secondary); margin-bottom: 4px;">Type</div>
                        <div style="font-weight: 500;">${item.source === 'github' ? 'GitHub Repository' : 'n8n Workflow'}</div>
                    </div>
                    <div>
                        <div style="color: var(--text-secondary); margin-bottom: 4px;">Category</div>
                        <div style="font-weight: 500;">${getCategoryName(item.category)}</div>
                    </div>
                    ${item.source === 'github' ? `
                    <div>
                        <div style="color: var(--text-secondary); margin-bottom: 4px;">Stars</div>
                        <div style="font-weight: 500; color: var(--accent);">${formatNumber(item.stars)}</div>
                    </div>
                    ` : `
                    <div>
                        <div style="color: var(--text-secondary); margin-bottom: 4px;">Complexity</div>
                        <div style="font-weight: 500;">${item.nodes} nodes</div>
                    </div>
                    `}
                </div>
                ${item.url ? `
                <a href="${item.url}" target="_blank" 
                   style="display: inline-block; background: var(--accent); color: var(--bg); 
                          padding: 8px 16px; border-radius: var(--radius); text-decoration: none; 
                          font-weight: 500; font-size: 14px;">
                    View ${item.source === 'github' ? 'Repository' : 'Workflow'}
                </a>
                ` : ''}
            `;
            
            DOM.modalBody.innerHTML = content;
            DOM.modal.classList.add('active');
        }

        // Cache management
        function cacheData(data) {
            try {
                localStorage.setItem(CONFIG.CACHE_KEY, JSON.stringify({
                    data: data,
                    timestamp: Date.now()
                }));
            } catch (e) {
                console.warn('Cache failed:', e);
            }
        }

        function getCachedData() {
            try {
                const cached = localStorage.getItem(CONFIG.CACHE_KEY);
                if (!cached) return null;
                
                const { data, timestamp } = JSON.parse(cached);
                const age = Date.now() - timestamp;
                
                if (age > CONFIG.CACHE_TTL) {
                    localStorage.removeItem(CONFIG.CACHE_KEY);
                    return null;
                }
                
                return data;
            } catch (e) {
                return null;
            }
        }

        // UI helpers
        function showLoading() {
            DOM.loading.style.display = 'block';
            DOM.itemsList.innerHTML = '';
        }

        function hideLoading() {
            DOM.loading.style.display = 'none';
        }

        function updateLastUpdate() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString([], { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: false 
            });
            DOM.lastUpdate.textContent = timeStr;
        }

        // Utility functions
        function escapeHTML(str) {
            if (!str) return '';
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'k';
            return num.toString();
        }

        function extractRepoPath(url) {
            if (!url) return '';
            try {
                const parts = url.split('/');
                return parts.slice(-2).join('/');
            } catch {
                return url;
            }
        }

        function getPriority(level) {
            return level === 'critical' ? 'critical' : 
                   level === 'high' ? 'high' : 'medium';
        }

        function getCategoryName(category) {
            const names = {
                'ai_infra': 'AI Infrastructure',
                'gov': 'Government Tech',
                'finance': 'Fintech',
                'health': 'Health Tech',
                'climate': 'Climate Tech',
                'sales': 'Sales',
                'trading': 'Trading',
                'devops': 'DevOps',
                'infra': 'Infrastructure',
                'data': 'Data',
                'support': 'Support'
            };
            return names[category] || category;
        }

        // Global functions for inline event handlers
        window.openItemDetail = openItemDetail;
        window.goToPage = goToPage;
        window.loadData = loadData;

        console.log('OpenIndex loaded - Ultra Light Mode');
    </script>
</body>
</html>
